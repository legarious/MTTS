<section class="mapper">
    <header class="page-header-map">
        <div class="container-fluid">
            <h2 class="no-margin-bottom">All Truck Running</h2>
        </div>
    </header>
    <div class="container-fluid">
        <div id="map" style="margin: 0 auto;" class=" has-shadow"></div>
        <script>

        </script>

    </div>
</section>
<script>
    (function () {
        var socket = io('http://localhost:3000');
        //Map create
        var map = L.map('map').setView([14.065507, 100.607233], 16);
        L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(map);
        var create = false;
        var marker;
        socket.on('c', function (data) {
            var lat = data.x;
            var long = data.y;
            if (create == false) {
                marker = L.marker([lat, long]).addTo(map);
                console.log(marker);
                create = true;
            } else {
                var newLatLng = new L.LatLng(lat, long);
                marker.setLatLng(newLatLng);
                marker.bindPopup("<b>Hello world!</b><br>Follow me!!!!").openPopup();
                map.setView([lat, long]);
            }
            console.log(data);
        });
        socket.on('d', function (online) {
            $('#online').html(online);
        });
        socket.on('h', function (countpeople) {
            $('#countpeople').html(countpeople);
            console.log(countpeople);
        });
    })();
</script>